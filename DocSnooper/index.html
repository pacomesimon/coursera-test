<!DOCTYPE html>
<html>
<head>
	
	


	<title>buns, Hello Coursera!</title>

</head>
<body>
<h1>buns, Hello Coursera!</h1>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.0.246/pdf.min.js"></script>
<script>
	    // Path to PDF file
	    
	    var PDF_URL = './example.pdf';
	    // var PDF_URL = 'https://www.nerldc.in/wp-content/uploads/ISO_14001_2015_EMS.pdf';
	    // Specify the path to the worker
	    PDFJS.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.0.246/pdf.worker.min.js';


		PDFJS.getDocument(PDF_URL).then(function (PDFDocumentInstance) {

		    var pdfDocument = pdf;
		    // Create an array that will contain our promises 
		    var pagesPromises = [];

		    for (var i = 0; i < pdf.numPages; i++) {
		        // Required to prevent that i is always the total of pages
		        (function (pageNumber) {
		            // Store the promise of getPageText that returns the text of a page
		            pagesPromises.push(getPageText(pageNumber, pdfDocument));
		        })(i + 1);
		    }

		    // Execute all the promises
		    Promise.all(pagesPromises).then(function (pagesText) {

		        // Display text of all the pages in the console
		        // e.g ["Text content page 1", "Text content page 2", "Text content page 3" ... ]
		        console.log(pagesText);
		    });

		}, function (reason) {
		    // PDF loading error
		    console.error(reason);
		});

		// /**
		//  * Retrieves the text of a specif page within a PDF Document obtained through pdf.js 
		//  * 
		//  * @param {Integer} pageNum Specifies the number of the page 
		//  * @param {PDFDocument} PDFDocumentInstance The PDF document obtained 
		//  **/
		// function getPageText(pageNum, PDFDocumentInstance) {
		//     // Return a Promise that is solved once the text of the page is retrieven
		//     return new Promise(function (resolve, reject) {
		//         PDFDocumentInstance.getPage(pageNum).then(function (pdfPage) {
		//             // The main trick to obtain the text of the PDF page, use the getTextContent method
		//             pdfPage.getTextContent().then(function (textContent) {
		//                 var textItems = textContent.items;
		//                 var finalString = "";

		//                 // Concatenate the string of the item to the final string
		//                 for (var i = 0; i < textItems.length; i++) {
		//                     var item = textItems[i];

		//                     finalString += item.str + " ";
		//                 }

		//                 // Solve promise with the text retrieven from the page
		//                 resolve(finalString);
		//             });
		//         });
		//     });
		// }

		// window.pageTexts = [];
		// function pushToTheGlobal(pageNumber, textPage) {
		// 	window.pageTexts[pageNumber] = textPage;
		// 	console.log(window.pageTexts[pageNumber]);
		// }

		
		// 			// var PDF_URL  = '/path/to/example.pdf';

		// 	PDFJS.getDocument(PDF_URL).then(function (PDFDocumentInstance) {
			    
		// 	    var totalPages = PDFDocumentInstance.numPages;
		// 	    var pageNumber = 1;

		// 	    for (pageNumber = 1; pageNumber <= totalPages; pageNumber++) { 
		// 	    // Extract the text
		// 	    	// window.textNeeded = "";
		// 		    getPageText(pageNumber , PDFDocumentInstance).then(function(textPage){
		// 		        // Show the text of the page in the console
		// 		        // console.log(textPage);
		// 		        pushToTheGlobal(pageNumber,textPage);
		// 		    });
				    
		// 		}
		// 		console.log(window.pageTexts);
		// 		console.log("something is here");
		// 		console.log(window.pageTexts[73]);
		// 		console.log(window.pageTexts[74]);
		// 		console.log(window.pageTexts[75]);
		// 	}, function (reason) {
		// 	    // PDF loading error
		// 	    console.error(reason);
		// 	});


		
		//////////////////////document.getElementById('demo').innerHTML = "mi Array" + pageTexts;
		// var totalPages = pageTexts.length - 1 ;
		// var textToShow = "<br>";
		// for (let i = 1; i <= totalPages ; i++) {
		// 	textToShow = textToShow + "<h1> page " + i +"</h1> <br>" + pageTexts[i] + "<br> ===================== <br>";
		// 	document.getElementById('demo').innerHTML = textToShow ;
		// }

	</script>

	<p id="demo"></p>
</body>
</html>